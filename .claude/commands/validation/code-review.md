---
description: 提交前的技术代码审查
---

对最近更改的文件进行技术代码审查。

## 核心原则

- 简洁是终极的复杂 - 每行代码都应证明其存在价值
- 代码被阅读的次数远多于编写 - 优化可读性
- 最好的代码往往是你不写的代码

## 审查内容

先了解代码库标准：
- CLAUDE.md
- README.md
- /docs 目录中的标准文档

然后运行：

```bash
git status
git diff HEAD
git diff --stat HEAD
git ls-files --others --exclude-standard
```

完整阅读每个新文件和更改的文件（不仅是 diff）。

## 审查要点

1. **逻辑错误** - 边界错误、条件错误、缺少错误处理、竞态条件
2. **安全问题** - SQL 注入、XSS、不安全数据处理、暴露密钥
3. **性能问题** - N+1 查询、低效算法、内存泄漏
4. **代码质量** - DRY 违规、过度复杂、命名不当、缺少类型提示
5. **遵循标准** - lint/类型/格式、日志、测试标准

## 验证问题

- 运行相关测试
- 确认类型错误真实
- 验证安全问题有上下文

## 输出格式

保存到：`.agents/code-reviews/[名称].md`

**统计**：
- 修改文件数
- 新增文件数
- 新增/删除行数

**每个问题**：
```
severity: critical|high|medium|low
file: path/to/file.py
line: 42
issue: [一行描述]
detail: [为什么是问题]
suggestion: [如何修复]
```

无问题则输出："代码审查通过。未检测到技术问题。"

## 重要

- 具体（行号，不要模糊抱怨）
- 关注真正的 bug，不是风格
- 建议修复，不只是抱怨
- 安全问题标记为 CRITICAL
